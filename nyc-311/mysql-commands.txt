CREATE TABLE `calls` (
 `unique_key` int(11) NOT NULL,
 `created_date` datetime DEFAULT NULL,
 `closed_date` datetime DEFAULT NULL,
 `agency` varchar(50) COLLATE latin1_general_ci DEFAULT NULL,
 `agency_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `complaint_type` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `descriptor` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `location_type` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `incident_zip` int(11) DEFAULT NULL,
 `incident_address` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `street_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `cross_street1` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `cross_street2` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `intersection1` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `intersection2` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `address_type` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `city` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `landmark` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `facility_type` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `status` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `due_date` datetime DEFAULT NULL,
 `resolution_description` text COLLATE latin1_general_ci,
 `resolution_action_updated_date` datetime DEFAULT NULL,
 `community_board` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `borough` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `x_coordinate` int(11) DEFAULT NULL,
 `y_coordinate` int(11) DEFAULT NULL,
 `park_facility` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `park_borough` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_number` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_region` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_code` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_phone_number` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_address` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_city` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_state` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_zip` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_not_found` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `school_or_citywide_complaint` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `vehicle_type` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `taxi_company_borough` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `taxi_pick_up_location` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `bridge_highway_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `bridge_highway_direction` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `road_ramp` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `bridge_highway_segment` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `garage_lot_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `ferry_direction` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `ferry_terminal_name` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 `latitude` double(20,17) DEFAULT NULL,
 `longitude` double(20,17) DEFAULT NULL,
 `location` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,
 PRIMARY KEY (`unique_key`)
)


LOAD DATA LOCAL INFILE './311.csv' INTO TABLE calls FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' IGNORE 1 LINES (unique_key, @created_date, @closed_date, agency, agency_name, complaint_type, descriptor, location_type, @incident_zip, incident_address, street_name, cross_street1, cross_street2, intersection1, intersection2, address_type, city, landmark, facility_type, status, @due_date, resolution_description, @resolution_action_updated_date, community_board, borough, @x_coordinate, @y_coordinate, park_facility, park_borough, school_name, school_number, school_region, school_code, school_phone_number, school_address, school_city, school_state, school_zip, school_not_found, school_or_citywide_complaint, vehicle_type, taxi_company_borough, taxi_pick_up_location, bridge_highway_name, bridge_highway_direction, road_ramp, bridge_highway_segment, garage_lot_name, ferry_direction, ferry_terminal_name, @latitude, @longitude, location)
SET created_date = STR_TO_DATE(@created_date,'%m/%d/%Y %h:%i:%s %p'),
closed_date=STR_TO_DATE(@closed_date,'%m/%d/%Y %h:%i:%s %p'),
resolution_action_updated_date=STR_TO_DATE(@resolution_action_updated_date, '%m/%d/%Y %h:%i:%s %p'),
due_date=STR_TO_DATE(@due_date, '%m/%d/%Y %h:%i:%s %p'),
incident_zip=NULLIF(@incident_zip, ''),
latitude=NULLIF(@latitude, ''),
longitude=NULLIF(@longitude, ''),
x_coordinate=NULLIF(@x_coordinate,''),
y_coordinate=NULLIF(@y_coordinate,'');

